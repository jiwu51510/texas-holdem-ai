# 双维度胜率-策略相关性验证实验报告

## 实验目的

验证：**当两个手牌同时满足以下两个条件时，它们的最优策略是否相同？**

1. **手牌vs对手范围的胜率**相同或接近（差异<3%）
2. **自己范围vs对手范围的胜率**相同（因为是同一个范围，所以完全相同）

如果这两个胜率标量能完全决定策略，那么满足上述条件的手牌应该有相同的策略。

## 实验方法

1. 使用CFR（反事实遗憾最小化）算法计算河牌阶段的纳什均衡策略
2. 计算每个手牌的两个胜率维度：
   - **手牌胜率**：该手牌vs对手范围的胜率
   - **范围胜率**：自己范围vs对手范围的胜率（所有手牌共享同一个值）
3. 找出双维度胜率都相近的手牌对（手牌胜率差<3%，范围胜率相同）
4. 比较这些手牌对的策略差异

## 关键发现

### 场景1：干燥牌面 K♠T♦7♣4♥2♠

**范围vs范围胜率**: 48.30%（所有手牌共享）

| 手牌1 | 手牌2 | 手牌胜率 | 范围胜率 | 策略1 | 策略2 | 策略差异 |
|-------|-------|----------|----------|-------|-------|----------|
| 66 (一对) | 88 (一对) | 19.05% vs 21.55% | 48.30% | check 87% | check 100% | 12.72% |

**分析**：66和88都是低对，手牌胜率相近（差异2.5%），范围胜率完全相同，但策略有差异。


### 场景2：湿润牌面 J♠T♥9♦5♣2♠（顺子可能）

**范围vs范围胜率**: 44.92%（所有手牌共享）

| 手牌1 | 手牌2 | 手牌胜率 | 范围胜率 | 策略1 | 策略2 | 策略差异 |
|-------|-------|----------|----------|-------|-------|----------|
| 76s (高牌) | 88 (一对) | 0.00% vs 0.00% | 44.92% | check 100% | **bet 74%** | **73.78%** |

**分析**：
- 76s和88在这个牌面都是0%胜率（被所有对手范围打败）
- 范围胜率完全相同（44.92%）
- **但策略完全不同！** 76s应该check，88应该bet（诈唬）
- 原因：88有阻断效应，阻断了对手的88组合

### 场景3：同花牌面 A♥J♥8♥5♥2♦（四张同花）

**范围vs范围胜率**: 45.24%（所有手牌共享）

| 手牌1 | 手牌2 | 手牌胜率 | 范围胜率 | 策略1 | 策略2 | 策略差异 |
|-------|-------|----------|----------|-------|-------|----------|
| QsTs (高牌) | QdQs (一对) | 0.00% vs 0.00% | 45.24% | check 100% | **bet 100%** | **99.90%** |
| QsTs (高牌) | KdTd (高牌) | 0.00% vs 0.00% | 45.24% | check 100% | **bet 74%** | **73.70%** |
| QsTs (高牌) | KsTs (高牌) | 0.00% vs 0.00% | 45.24% | check 100% | **bet 73%** | **72.72%** |

**分析**：
- 这些手牌都是0%胜率（没有同花，被所有同花打败）
- 范围胜率完全相同（45.24%）
- **但策略完全不同！**
  - QsTs：没有阻断效应，应该check放弃
  - QdQs：有Q♦阻断对手的同花，可以诈唬
  - KdTd/KsTs：有K阻断对手的强同花，可以诈唬

### 场景4：配对牌面 K♠K♦9♣5♥2♠（葫芦可能）

**范围vs范围胜率**: 42.01%（所有手牌共享）

| 手牌1 | 手牌2 | 手牌胜率 | 范围胜率 | 策略1 | 策略2 | 策略差异 |
|-------|-------|----------|----------|-------|-------|----------|
| 77 (两对) | A9s (两对) | 16.67% vs 18.42% | 42.01% | check 100% | **bet 99%** | **98.55%** |
| 66 (两对) | A9s (两对) | 16.67% vs 18.42% | 42.01% | check 100% | **bet 99%** | **98.55%** |

**分析**：
- 77和A9s都是两对，手牌胜率相近（差异1.75%）
- 范围胜率完全相同（42.01%）
- **但策略完全不同！**
  - 77：小两对，应该check控池
  - A9s：有A的两对，可以价值下注


## 统计汇总

| 场景 | 范围胜率 | 双维度相近对数 | 策略差异显著数 | 最优动作不同率 |
|------|----------|----------------|----------------|----------------|
| 干燥牌面 | 48.30% | 411 | 72 | 0% |
| 湿润牌面 | 44.92% | 373 | 78 | 高 |
| 同花牌面 | 45.24% | 28 | 5 | 高 |
| 配对牌面 | 42.01% | 391 | 71 | 高 |

**总计**: 1203 对双维度胜率相近的手牌，其中 **226 对策略差异显著**

## 核心结论

### ⚠️ 双维度胜率标量不足以决定最优策略

实验发现大量满足以下条件的手牌对：
- ✅ 手牌vs对手范围的胜率相近（差异<3%）
- ✅ 范围vs范围的胜率完全相同
- ❌ **但策略完全不同！**

这证明了仅靠两个胜率标量无法替代传统solver所需的完整信息。

### 典型反例

**最强反例：场景3同花牌面**
- QsTs vs QdQs
- 手牌胜率：0% vs 0%（完全相同）
- 范围胜率：45.24%（完全相同）
- 策略：check 100% vs **bet 100%**（完全相反！）

### 需要的额外信息

除了胜率标量，最优策略还需要考虑：

1. **绝对牌力**：手牌的牌型（三条 > 两对 > 一对 > 高牌）
2. **相对牌力**：在当前牌面的相对强度
3. **阻断效应**：是否阻断对手的强牌组合
4. **范围结构**：自己范围是极化还是线性
5. **诈唬价值**：弱牌是否适合作为诈唬牌

## 实验数据文件

- 完整结果：`experiments/results/dual_equity_validation.json`
- 本报告：`experiments/results/dual_equity_validation_report.md`
- 实验脚本：`run_dual_equity_validation.py`
