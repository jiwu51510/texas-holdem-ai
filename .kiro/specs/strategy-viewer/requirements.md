# 需求文档

## 简介

策略查看器是一个可视化工具，用于检查和分析德州扑克AI模型在各个决策节点的策略。该工具允许用户通过游戏树导航浏览不同的游戏状态，查看13x13手牌范围矩阵的策略分布，并获取每个手牌组合的详细行动概率。

## 术语表

- **策略查看器（Strategy Viewer）**：用于可视化和分析AI策略的图形界面工具
- **游戏树（Game Tree）**：表示德州扑克所有可能决策路径的树形结构
- **信息集（Information Set）**：玩家在某一时刻所知道的所有信息的集合
- **手牌范围矩阵（Hand Range Matrix）**：13x13的矩阵，显示所有169种起手牌组合
- **策略分布（Strategy Distribution）**：在给定状态下各行动的概率分布
- **节点（Node）**：游戏树中的一个决策点
- **公共牌（Board Cards）**：翻牌、转牌、河牌阶段发出的公共牌

## 需求

### 需求 1

**用户故事：** 作为AI研究员，我希望能够加载训练好的模型检查点，以便分析模型学到的策略。

#### 验收标准

1. WHEN 用户选择一个检查点文件 THEN 策略查看器 SHALL 加载该模型并显示加载成功状态
2. WHEN 检查点文件格式无效或损坏 THEN 策略查看器 SHALL 显示明确的错误信息并保持当前状态
3. WHEN 模型加载完成 THEN 策略查看器 SHALL 显示模型的元数据信息（训练迭代次数、时间戳等）

### 需求 2

**用户故事：** 作为AI研究员，我希望能够通过游戏树导航浏览不同的决策节点，以便理解模型在各种情况下的决策。

#### 验收标准

1. WHEN 策略查看器启动 THEN 策略查看器 SHALL 显示从"Game Begin"开始的游戏树根节点
2. WHEN 用户点击一个游戏阶段节点（Preflop/Flop/Turn/River） THEN 策略查看器 SHALL 展开该阶段的可用行动选项
3. WHEN 用户选择一个行动（Fold/Call/Raise等） THEN 策略查看器 SHALL 更新当前节点并显示该节点的策略信息
4. WHEN 用户在游戏树中导航 THEN 策略查看器 SHALL 维护并显示完整的行动历史路径
5. WHEN 用户点击历史路径中的任意节点 THEN 策略查看器 SHALL 回退到该节点状态

### 需求 3

**用户故事：** 作为AI研究员，我希望能够查看13x13手牌范围矩阵，以便直观了解不同手牌的策略分布。

#### 验收标准

1. WHEN 用户选择一个决策节点 THEN 策略查看器 SHALL 显示13x13的手牌范围矩阵
2. WHEN 显示手牌矩阵 THEN 策略查看器 SHALL 使用颜色编码表示主要行动（绿色=加注/跟注，红色=弃牌，混合色=混合策略）
3. WHEN 手牌组合为同花（如AKs） THEN 策略查看器 SHALL 在矩阵的上三角区域显示
4. WHEN 手牌组合为非同花（如AKo） THEN 策略查看器 SHALL 在矩阵的下三角区域显示
5. WHEN 手牌组合为对子（如AA） THEN 策略查看器 SHALL 在矩阵的对角线上显示

### 需求 4

**用户故事：** 作为AI研究员，我希望能够查看每个手牌组合的详细策略概率，以便精确分析模型的决策。

#### 验收标准

1. WHEN 用户将鼠标悬停在手牌矩阵的某个格子上 THEN 策略查看器 SHALL 显示该手牌的详细策略概率
2. WHEN 显示详细策略 THEN 策略查看器 SHALL 列出所有可用行动及其对应的概率百分比
3. WHEN 手牌有多个花色组合（如2s2h、2s2c、2s2d等） THEN 策略查看器 SHALL 分别显示每个组合的策略
4. WHEN 策略概率显示 THEN 策略查看器 SHALL 确保所有行动概率之和为100%

### 需求 5

**用户故事：** 作为AI研究员，我希望能够查看当前游戏状态的详细信息，以便理解策略的上下文。

#### 验收标准

1. WHEN 用户选择一个决策节点 THEN 策略查看器 SHALL 显示当前公共牌（如果有）
2. WHEN 用户选择一个决策节点 THEN 策略查看器 SHALL 显示当前玩家编号
3. WHEN 用户选择一个决策节点 THEN 策略查看器 SHALL 显示总玩家数
4. WHEN 用户选择一个决策节点 THEN 策略查看器 SHALL 显示当前底池大小
5. WHEN 用户选择一个决策节点 THEN 策略查看器 SHALL 显示当前玩家筹码
6. WHEN 用户选择一个决策节点 THEN 策略查看器 SHALL 显示当前游戏阶段（Preflop/Flop/Turn/River）

### 需求 6

**用户故事：** 作为AI研究员，我希望能够设置公共牌来分析特定牌面下的策略，以便研究模型对不同牌面的反应。

#### 验收标准

1. WHEN 用户切换到"BoardCards"标签页 THEN 策略查看器 SHALL 显示公共牌设置界面
2. WHEN 用户选择特定的公共牌组合 THEN 策略查看器 SHALL 更新手牌矩阵以反映该牌面下的策略
3. WHEN 用户设置的公共牌与某些手牌冲突 THEN 策略查看器 SHALL 在矩阵中禁用或标记这些冲突的手牌组合
4. WHEN 公共牌设置改变 THEN 策略查看器 SHALL 自动重新计算并更新所有策略显示

### 需求 7

**用户故事：** 作为AI研究员，我希望策略查看器提供流畅的用户界面，以便高效地进行策略分析。

#### 验收标准

1. WHEN 策略查看器加载 THEN 策略查看器 SHALL 在3秒内完成初始化并显示界面
2. WHEN 用户切换节点 THEN 策略查看器 SHALL 在500毫秒内更新策略显示
3. WHEN 用户调整窗口大小 THEN 策略查看器 SHALL 自适应调整布局
4. WHEN 用户进行任何操作 THEN 策略查看器 SHALL 提供视觉反馈表明操作已被接收

### 需求 8

**用户故事：** 作为AI研究员，我希望能够导出策略分析结果，以便在报告或论文中使用。

#### 验收标准

1. WHEN 用户请求导出当前视图 THEN 策略查看器 SHALL 生成手牌矩阵的图片文件
2. WHEN 用户请求导出策略数据 THEN 策略查看器 SHALL 生成包含所有手牌策略概率的JSON文件
3. WHEN 导出完成 THEN 策略查看器 SHALL 显示导出成功的确认信息和文件保存位置

### 需求 9

**用户故事：** 作为AI研究员，我希望能够查看价值网络对不同手牌的价值估计，以便理解模型对手牌强度的评估。

#### 验收标准

1. WHEN 检查点包含价值网络参数 THEN 策略查看器 SHALL 加载价值网络并显示加载成功状态
2. WHEN 用户切换到"价值估计"标签页 THEN 策略查看器 SHALL 显示13x13手牌范围矩阵的价值估计热图
3. WHEN 显示价值热图 THEN 策略查看器 SHALL 使用颜色编码表示价值高低（绿色=高价值，红色=低价值）
4. WHEN 用户将鼠标悬停在价值热图的某个格子上 THEN 策略查看器 SHALL 显示该手牌的具体价值估计数值
5. WHEN 检查点不包含价值网络参数 THEN 策略查看器 SHALL 显示"价值网络不可用"提示并禁用价值估计功能
